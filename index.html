import React, { useState } from "react";
import { Slider } from "@mui/material";
import { Card, CardContent } from "@/components/ui/card";

const lensData = [
  {
    name: "FineVision HP",
    description: "読書に強く、三焦点で全距離に対応する近方重視型レンズ。",
    contrast: 86,
    driving: 4.94,
    computer: 6.0,
    reading: 9.5,
  },
  {
    name: "PanOptix",
    description: "バランス型の三焦点レンズで全距離での視力をカバー。",
    contrast: 88,
    driving: 6.46,
    computer: 7.0,
    reading: 8.08,
  },
  {
    name: "Vivity",
    description: "EDOF型で中間距離と鮮明さに優れる。",
    contrast: 98,
    driving: 8.44,
    computer: 8.0,
    reading: 6.0,
  },
  {
    name: "Monofocal",
    description: "遠方に最適化された単焦点レンズ。",
    contrast: 99,
    driving: 9.5,
    computer: 5.0,
    reading: 2.0,
  },
];

export default function IOLMatchApp() {
  const [weights, setWeights] = useState({ contrast: 25, driving: 25, computer: 25, reading: 25 });
  const totalWeight = Object.values(weights).reduce((a, b) => a + b, 0) || 1;

  const scoredLenses = lensData.map((lens) => {
    const score =
      (lens.contrast * weights.contrast +
        lens.driving * weights.driving +
        lens.computer * weights.computer +
        lens.reading * weights.reading) /
      totalWeight;
    return { ...lens, score: score.toFixed(2) };
  });

  const top3 = scoredLenses.sort((a, b) => b.score - a.score).slice(0, 3);

  return (
    <div className="p-6 space-y-6">
      <h1 className="text-2xl font-bold text-center">あなたに合った多焦点レンズ診断</h1>
      <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
        {Object.keys(weights).map((key) => (
          <div key={key}>
            <label className="font-semibold">
              {key === "contrast"
                ? "鮮明さ（コントラスト）"
                : key === "driving"
                ? "運転（遠方）"
                : key === "computer"
                ? "パソコン（60cm）"
                : "読書（近方）"}
            </label>
            <Slider
              value={weights[key]}
              min={0}
              max={100}
              onChange={(e, value) => setWeights({ ...weights, [key]: value })}
              valueLabelDisplay="auto"
              className="mt-2"
            />
          </div>
        ))}
      </div>

      <div className="pt-4">
        <h2 className="text-xl font-semibold mb-4">おすすめレンズ TOP 3</h2>
        <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
          {top3.map((lens, index) => (
            <Card key={lens.name} className="rounded-2xl shadow-md p-4">
              <CardContent>
                <h3 className="text-lg font-bold">{index + 1}. {lens.name}</h3>
                <p className="text-sm mt-1">{lens.description}</p>
                <p className="text-sm mt-2">スコア: <span className="font-bold">{lens.score}</span></p>
              </CardContent>
            </Card>
          ))}
        </div>
      </div>
    </div>
  );
}
