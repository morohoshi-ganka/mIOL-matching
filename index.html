<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>å¤šç„¦ç‚¹ãƒ¬ãƒ³ã‚ºè¨ºæ–­</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- noUiSlider ã®ã‚¹ã‚¿ã‚¤ãƒ« -->
  <link
    href="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/14.7.0/nouislider.min.css"
    rel="stylesheet"
  />

  <style>
    body { font-family: Arial, sans-serif; padding:20px; max-width:600px; margin:auto; background:#f5f5f5; }
    h1 { text-align:center; margin-bottom:0.2em; }
    p { text-align:center; color:#555; }

    /* ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼å¸¯ã®ç«‹ä½“æ„Ÿ */
    #multi-slider.noUi-target {
      background: #ddd;
      box-shadow:
        inset 0 4px 8px rgba(0,0,0,0.2),
        inset 0 -2px 4px rgba(0,0,0,0.1);
      border-radius: 20px;
      height: 24px;
      margin: 40px 0;
    }
    /* ãƒãƒ³ãƒ‰ãƒ«ã®ç«‹ä½“æ„Ÿ */
    .noUi-handle {
      box-shadow: 0 4px 6px rgba(0,0,0,0.5);
      border-radius: 50%;
      height: 32px;
      width: 32px;
      top: -4px;
      background: #fff;
      border: 2px solid rgba(0,0,0,0.3);
      transition: transform 0.1s;
    }
    .noUi-handle:hover { transform: scale(1.1); }

    /* ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—éè¡¨ç¤º */
    .noUi-tooltip { display: none !important; }

    /* å„ã‚»ã‚°ãƒ¡ãƒ³ãƒˆã‚’å€‹åˆ¥è‰²ã§å¡—ã‚‹ */
    .noUi-connect { background: transparent; }
    #multi-slider .noUi-connect:nth-child(1) { background: #4CAF50; }
    #multi-slider .noUi-connect:nth-child(2) { background: #2196F3; }
    #multi-slider .noUi-connect:nth-child(3) { background: #FFC107; }
    #multi-slider .noUi-connect:nth-child(4) { background: #E91E63; }

    /* ãƒ©ãƒ™ãƒ«è¡¨ç¤ºç”¨ */
    #labels { position: relative; height: 0; }
    .segment-label {
      position: absolute;
      color: black;
      font-size: 0.85em;
      text-shadow: 0 1px 1px rgba(255,255,255,0.8);
      transform: translate(-50%, -50%);
      pointer-events: none;
      white-space: nowrap;
    }

    /* æ±ºå®šãƒœã‚¿ãƒ³ */
    #confirm-btn {
      display: block;
      margin: 20px auto;
      padding: 10px 20px;
      font-size: 1em;
      background: #1976D2;
      color: white;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0 2px 4px rgba(0,0,0,0.3);
      transition: background 0.2s;
    }
    #confirm-btn:hover { background: #1565C0; }

    /* çµæœè¡¨ç¤º */
    #results {
      white-space: pre-wrap;
      margin-top: 80px;
      font-size: 1em;
      background: #fff;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
  </style>
</head>
<body>
  <h1>ğŸ‘ å¤šç„¦ç‚¹ãƒ¬ãƒ³ã‚ºè¨ºæ–­</h1>
  <p>ï¼“æœ¬ã®ãƒãƒ³ãƒ‰ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°ã—ã¦ã€Œé®®æ˜ã•â‡”é‹è»¢â‡”ãƒ‘ã‚½ã‚³ãƒ³â‡”èª­æ›¸ã€ã®ãƒãƒ©ãƒ³ã‚¹ã‚’èª¿æ•´ã—ã€ã€Œæ±ºå®šã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚</p>

  <!-- ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼æœ¬ä½“ -->
  <div id="multi-slider"></div>
  <!-- ã‚»ã‚°ãƒ¡ãƒ³ãƒˆåï¼‹ï¼…ãƒ©ãƒ™ãƒ«é…ç½®é ˜åŸŸ -->
  <div id="labels"></div>
  <!-- æ±ºå®šãƒœã‚¿ãƒ³ -->
  <button id="confirm-btn">æ±ºå®š</button>
  <!-- è¨ºæ–­çµæœ -->
  <pre id="results"></pre>

  <!-- noUiSlider ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆ -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/14.7.0/nouislider.min.js"></script>
  <script>
    // æ­£è¦åŒ–æ¸ˆã¿ã‚¹ã‚³ã‚¢ãƒ‡ãƒ¼ã‚¿ï¼ˆå„é …ç›®Max25ï¼‰
    const lensData = [
      {name:"FineVision HP", score:[25.00,12.99,16.49,21.72]},
      {name:"PanOptix",     score:[21.26,17.01,19.23,22.22]},
      {name:"Vivity",       score:[15.63,22.22,21.98,24.75]},
      {name:"Monofocal",    score:[ 5.26,25.00,13.73,25.00]},
    ];

    const slider = document.getElementById('multi-slider');
    const labelsEl = document.getElementById('labels');
    const resultsEl = document.getElementById('results');
    const confirmBtn = document.getElementById('confirm-btn');
    const names = ['é®®æ˜ã•','é‹è»¢','ãƒ‘ã‚½ã‚³ãƒ³','èª­æ›¸'];

    // ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼åˆæœŸåŒ–
    noUiSlider.create(slider, {
      start: [25, 50, 75],
      connect: [true, true, true, true],
      range: { min: 0, max: 100 },
      step: 1,
      behaviour: 'drag',
      tooltips: [true, true, true]
    });

    // åˆæœŸãƒ©ãƒ™ãƒ«ï¼ˆåå‰ã®ã¿ï¼‰
    (function() {
      const a=25, b=50, c=75;
      const seg=[a, b-a, c-b, 100-c];
      let acc=0;
      seg.forEach((pct,i)=>{
        const x=acc + pct/2;
        const span=document.createElement('span');
        span.className='segment-label';
        span.style.left=x+'%';
        span.style.top=(slider.getBoundingClientRect().height/2 + 10)+'px';
        span.textContent=names[i];
        labelsEl.appendChild(span);
        acc+=pct;
      });
    })();

    // æ›´æ–°æ™‚ï¼šï¼…ãƒ©ãƒ™ãƒ«ã¨éè¡¨ç¤ºãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—
    slider.noUiSlider.on('update', (values) => {
      // ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆãƒ©ãƒ™ãƒ«æ›´æ–°
      const a = +values[0], b = +values[1], c = +values[2];
      const seg=[a, b-a, c-b, 100-c];
      // ã‚¯ãƒªã‚¢æ—§ï¼…ãƒ©ãƒ™ãƒ«
      document.querySelectorAll('.pct-label').forEach(el=>el.remove());
      let acc=0;
      seg.forEach((pct,i)=>{
        const x=acc + pct/2;
        const span=document.createElement('span');
        span.className='segment-label pct-label';
        span.style.left=x+'%';
        span.style.top=(slider.getBoundingClientRect().height/2 + 28)+'px';
        span.textContent=pct.toFixed(1)+'%';
        labelsEl.appendChild(span);
        acc+=pct;
      });
      // ãƒ„ãƒ¼ãƒ«ãƒãƒƒãƒ—éè¡¨ç¤º
      slider.querySelectorAll('.noUi-tooltip').forEach(t=>t.style.display='none');
    });

    // è¨ºæ–­ãƒ­ã‚¸ãƒƒã‚¯
    function diagnose() {
      const [a,b,c] = slider.noUiSlider.get().map(v=>+v);
      if(!(a<=b && b<=c)) return;
      const raw=[a, b-a, c-b, 100-c];
      const total=raw.reduce((s,x)=>s+x,0);
      const w=raw.map(x=>x/total);
      const scored=lensData.map(l=>({name:l.name,score:l.score.reduce((sum,v,i)=>sum + v*w[i],0)}))
        .sort((p,q)=>q.score-p.score).slice(0,3);
      let out='ã‚ãªãŸã«ãƒãƒƒãƒã™ã‚‹ãƒ¬ãƒ³ã‚ºã¯ãƒ»ãƒ»ãƒ»\n';
      scored.forEach((l,i)=>{ out+=`\n${i+1}ä½: ${l.name}ï¼ˆã‚¹ã‚³ã‚¢:${l.score.toFixed(2)}ï¼‰`; });
      resultsEl.textContent=out;
    }

    // æ±ºå®šãƒœã‚¿ãƒ³ã‚¯ãƒªãƒƒã‚¯
    confirmBtn.addEventListener('click', diagnose);

    // åˆæœŸè¨­å®š
    slider.noUiSlider.set([25,50,75]);
  </script>
</body>
</html>
